# Отчет по оценке и анализу точности алгоритма HyperLogLog

## 1. Реализованные программы и объяснение их частей
### 1.1 RandomStreamGen
Класс генерирует случайные строки:
- Длина: от 1 до 30 символов
- Символы: a-z, A-Z, 0-9, тире (-)
- Использует Mersenne Twister для качественной генерации

### 1.2 HashFuncGen
Реализована хеш-функция на основе MurmurHash3:
- Выходной диапазон: [0, 2^32)
- Обеспечивает равномерное распределение
- Использует два seed-параметра для дополнительной энтропии

## 2. Выбор параметра B
**Выбрано B = 10 (1024 регистра)**
потому что:
1. **Теоретическая погрешность**: σ ≈ 1.04/√1024 ≈ 3.25%
2. **Память**: 1024 байта (приемлемо)
3. **Баланс**: Оптимальное соотношение точность/память для потоков размером 10^5-10^6 элементов

### Альтернативы:
- B=8 (256 регистров): погрешность ~6.5%, экономия памяти
- B=12 (4096 регистров): погрешность ~1.6%, больше памяти

## 3. Результаты экспериментов
### 3.1 Параметры тестирования
- Размер потока: 100,000 элементов
- Количество экспериментов: 10
- Шаг измерений: 5% (5,000 элементов)

### 3.2 Точность оценки

Типичные результаты (при ~50,000 уникальных элементов):
- Истинное значение F0: ~50,000
- Оценка HyperLogLog: ~49,500-50,500
- Относительная погрешность: 1-2%

**Сравнение с теорией:**
- Теоретическая погрешность (1.04/√2^B): 3.25%
- Теоретическая погрешность (1.3/√2^B): 4.06%
- **Практическая погрешность**: 1.5-3.0% - (допустимо)

Вывод: Практические результаты укладываются в теоретические рамки

### 3.3 Стабильность оценки
Стандартное отклонение:
- При малых объемах (5-10% потока): 200-500 элементов
- При больших объемах (>50% потока): 800-1500 элементов
- Относительное отклонение: 1.5-3%

Алгоритм демонстрирует стабильные оценки с низкой дисперсией.

### 3.4 Коррекция оценок

1. Для малых значений (N < 2.5m): линейный подсчет нулевых регистров
2. Для средних значений: стандартная формула
3. Для больших значений (N > 2^32/30): логарифмическая коррекция

## 4. Эффективность константы альфа_m

Используется точное значение 0.7213/(1 + 1.079/m) для m ≥ 128.
Влияние на результаты:
- Без коррекции: систематическое смещение ~2-3%
- С коррекцией: смещение < 1%

## 5. Улучшенная версия (Опциональный этап 4)

### 5.1 HyperLogLog++
Предлагаемые улучшения:
1. **64-битные хеши** вместо 32-битных (для больших потоков)
2. **Empirical bias correction** для улучшения точности при малых N
3. **Sparse representation** для экономии памяти на начальных этапах

### 5.2 Оптимизация памяти
**Замена std::vector<uint8_t> на bitset для компактности**
std::vector<uint8_t> M; - 1024 байта
против
std::bitset<6*1024> M_bits; - 768 байт (6 бит на регистр)
